# 大前端环境下的思考

大前端：所谓就是所有前端的统称，比如 Android、iOS、web、Watch 等，最接近用户的那一层也就是UI层，然后将其统一起来，就是大前端。大前端最大的特点在于一次开发，同时适用于所有平台，开发者不用为一个 APP 需要做 Android 和 iOS 两种模式而担心。大前端是 web 统一的时代，利用 web 不仅能开发出网站，更可以开发手机端 web 应用和移动端应用程序。



**大纲**

- 思考一个简单的问题
- 大会的一些内容
- 一点想法



## 一个简单的问题

问题：我的肚子在咕噜咕噜的叫，怎么办？

解决方案：吃点东西



添加限制条件：由于某些原因，食道受伤了，无法直接进食，这下怎么解决？

解决方案：可能我们可以直接想到到注射一些葡萄糖注射液就能解决



进一步添加限制条件：由于个人的知识存在盲区没法上来就意识到注射葡萄糖注射液这种方案。或者是说目前这种方案还没出，那又怎么办？

由于没有现成的方案，我们只能通过**分析问题，然后思考方案，最后试验并得到最终的解法**。这整个过程是怎样的呢？



问题的分析：

为什么肚子会咕噜咕噜的叫。

机体的能量没有得到及时的补充 => 机体通知大脑 => 大脑发放食欲信号 => 产生饥饿感(感到饥饿，同时肚子咕噜咕噜的叫)

通过前面的原理我们知道，该问题的本质是：**机体需要补充能量**



怎么解决？

通过前面对问题的深刻剖析，我们的要解决的问题变成了：**要如何给机体补充能量** 。那么正常情况下机体是怎么补充能量的呢？

正常情况下机体补充能量的过程：

进食 => 食物经过消化系统消化吸收过转化为葡萄糖 => 葡萄糖进入组织细胞氧化分解，释放出能量以满足人体各项机能的需求。而多余的葡萄糖会合成为肝糖原，储存在肝脏中，当人体内的血糖浓度过低时，肝糖原会分解成人体所需的糖，为人体补充体力。

<img src="./food.png" alt="food" style="zoom:50%;" />



再结合前面提到的限制条件 **食道受伤了，无法直接进食**，我们可以这么做

1. 直接给胃接条管子，食物通过管子直接到胃，即不通过食道达到进食的目的 
2. 直接注视葡萄糖液，跳过消化系统吸收的环节
3. 补充肝糖原

至于哪种方案效果好，经济实惠，那就弄些小白鼠去试验试验。或者通过以上的分析之后我们再进一步去调查是否已经有相应的现成方案可以使用。这样问题是否就得以解决了？



**小结**

不知通过前面的问题大家是否意识到：当一个问题出现的时候，如果我本身就实践过或者了解过对应问题的解决方案时，问题的解决时一步到位的。但是问题往往没有那么简单，往往由于特定的原因会使得问题变复杂，这时怎么办？**回归原理，基于原理对问题进行分析，并逐步求解**。而通过前面的问题推导，我们不难发现基础原理的重要性。假设我们没有相应的生物基础知识，可能我们只能停留在 “肚子饿了”这么一个问题的表象上，问题也难以有所进展。

同理，在前端的领域，若是一个常规的问题，我已经解决过了或者本身就知道对应的解决方案，可能一步到位就解决了。但也常常会出现由于特定的业务场景使得一个问题变得复杂？这时我们往往需要依托对前端基础知识的深刻理解去对问题进行剖析并逐步找到相应的解决方案。



## 团队中存在的一些问题

1. vue 的模板中的添加事件要不要加 this

```html
<template>
  <div id="app">
    <span @click="onShowBtn">showBtn</span>
    <button @click="this.onClick" v-if="showBtn">button</button>
  </div>
</template>
```

底层原理：最后实现我们页面展示以及逻辑功能的一定是浏览器运行的 html、css、js 代码，那么来看看编译后的代码

```js
var render = function() {
    var _vm = this;
    var _h = _vm.$createElement;
    var _c = _vm._self._c || _h;
    return _c('div', {
        attrs: {
            "id": "app"
        }
    }, [_c('span', {
        on: {
            "click": _vm.onShowBtn
        }
    }, [_vm._v("showBtn")]), (_vm.showBtn) ? _c('button', {
        on: {
            "click": this.onClick
        }
    }, [_vm._v("button")]) : _vm._e()])
}
```

- template 的 html 代码，最终会被转成一个 render 函数
- 是否写 this 的运行结果是一样的
- 如果不写 this，那么在编译的过程中会帮我们自动加上



进一步：

- 既然写和不写的结果是一样的，那为啥要写
- 在模板中写 this ，this 的指向问题本身要怎么做解释（还记得 js 中 this 本身是动态的嘛？是有执行的方式定的嘛？）
  - 方法调用
  - 函数调用
  - apply、call、bind 的方式调用
- eslint、官网文档

​	

2. 为什么没有勇气拍定一个规范？

因为对底层的原理的理解不够深入，连自己都无法确定这到底对不对，如何去说服别人这么做。



## GMTC 中一些惊艳的分享

《[权衡与进化：JavaScript设计的艺术](https://gmtc.infoq.cn/2021/shenzhen/presentation/4274)》

讲了 javaScript 语言的设计哲学，以及当前所面临的一些困境。尤其值得引入注意的是一些看似简单的代码写法，其背后其实隐藏着非常多的思考。可能会给我们带来的引导，去主动思考语言特性背后的实现与思考。

《[Inside sablejs——打造更快更安全的 JavaScript 实现](https://gmtc.infoq.cn/2021/shenzhen/presentation/3927)》

需求是：基于虚拟机保护、设备特征识别、AI⾏为判断等多项功能打造的全⾯可靠的验证体系。

目前现有的方案都存在各种各样的问题，为了实现需求，自己实现了库 sablejs（ JavaScript In JavaScript ），大致思路是将对应的 js 代码专为 opc，然后在去解释执行 opc，毕竟牛逼和令人惊叹的是其分享的整个优化过程。整个的优化过程中借鉴了很多库和语言的优化思路。

---

ppt 中部分内容的摘录：

优化点

- 函数调⽤开销及消除 
- ⼀些编译期优化（计算操作与作⽤域） 
- 对象属性访问的优化 
- and more…

以上优化思路均来⾃各语⾔ VM 实现



优化的参考：

- macro
- Thanks, QuickJS !
- Thanks, PHP !
- Thanks, Lua and Ruby！
- Thanks, V8 !
- Future Plan

---



## 总结：

前端的工作内容是为用户提供一个人机交互的界面。但是为了这个交互过程的体验更好，往往我们要做的不仅仅是将设计师画的界面用代码实现而已。还要考虑到各种网络的环境（参考弱网优化相关的分享），各种页面性能（参考监控埋点、认证优化的分享），各种无障碍化。此外更要面对雇主所提出的研发效能升级的挑战（各种跨端、低代码、devOps）。内容多而纷繁复杂，身处这样的环境中不免有些疲倦，有些不知所措。职业之路究竟该怎么走？

笔者建议是不断的稳固前端相关的基础知识（html、css、javascript、浏览器的原理）、深入理解语言的概念、特性（甚至能了解到代码是如何被解释执行的）；同时不要限制自己，将自己定位为一位前端开发工程师，而应该将自己定位为一位**软件开发工程师**，只是我们更擅长解决软件问题中与前端相关的问题而已。最后请记得**当问题变得复杂而现成方案无法解决问题时，只有底层的原理能帮我们理解问题的本质并找到解决问题的方法**。
